<h2 align="center">ДЕТЕКТИРОВАНИЕ И КЛАССИФИКАЦИЯ ОБЪЕКТОВ НА ИЗОБРАЖЕНИЯХ С ПОМОЩЬЮ ГЛУБОКОГО ОБУЧЕНИЯ</h2>

**Ссылки**:
- [Вконтакте](https://vk.com/id404101172)
- [Telegram](https://t.me/bogdan_shnyra)

## Описание
Основные фрагменты модели сети. Загрузка и использование предобученной модели ResNet-152 для классификации изображений  с использованием PyTorch.

### Начальные параметры сети
-Загрузка предварительно обученной модели ResNet-152: model = models.resnet152(pretrained=True). Это говорит о том, что модель была обучена на большом наборе данных ImageNet и готова к использованию "из коробки" для задач распознавания объектов на изображениях.

### Параметры обучения
Прямые параметры обучения (гиперпараметры) не определены, так как используется модель только для инференса (распознавания). Однако для обучения используются такие параметры, как скорость обучения (learning rate), размер мини-батчей, количество эпох и так далее.
Conv2d: Слой свертки. Основные параметры:
   - inchannels: число каналов во входном изображении;
   - outchannels: количество фильтров, которое также определяет количество выходных каналов;
   - kernelsize: размер ядра свертки;
   - stride: шаг, с которым ядро свертки передвигается по изображению;
   - padding: добавление краёв, чтобы сохранить размеры изображения;
   - bias: флаг, указывающий на использование или отсутствие смещения в слое.
BatchNorm2d: Пакетная нормализация для 2D входов.Параметры включают:
   - numfeatures: количество входных признаков;
   - eps: добавочный параметр для обеспечения численной стабильности;
   - momentum: параметр, который используется для обновления скользящего среднего и дисперсии;
   - affine: определяет, обучаемы ли параметры масштабирования и смещения;
   - trackrunningstats: флаг, указывающий на необходимость отслеживания статистики во время обучения.
ReLU: Функция активации (Rectified Linear Unit), используется для введения нелинейности в модель.

### Слои со сверткой
ResNet-152 имеет множество сверточных слоев в своей архитектуре. Они автоматически включены в модель resnet152 и составляют основу для извлечения признаков из входных изображений. Слои со сквозными соединениями (residual connections) помогают обучать такие глубокие сети, как ResNet-152, предотвращая проблемы с эксплодинг градиентами.
1. Первый сверточный слой (conv1):
   - Принимает 3-канальное изображение (RGB) и применяет 64 фильтра размером 7x7 с шагом 2 и padding 3.
   - Такой большой размер ядра и шаг позволяют извлекать более обобщенные признаки и уменьшать размерность входа с самого начала.
2. Batch normalization (bn1):
   - Нормализует выход первого сверточного слоя, ускоряя процесс обучения и стабилизируя его.
3. ReLU activation (relu):
   - Вводит нелинейность в модель, что жизненно необходимо для изучения сложных представлений данных.

### Классификационные слои
Конечным элементом модели ResNet-152 является полносвязный слой, который используется для классификации изображений на 1000 классов из датасета ImageNet. Вычисленные скоры (logits) проходят через функцию softmax для определения вероятностей принадлежности к каждому из классов. Вы далее суммируете вероятности для классов, относящихся к кошкам (CAT_INDICES) и собакам (DOG_INDICES), для оценки принадлежности изображения к одной из этих двух категорий.
Дополнительные ключевые элементы кода:
- Предобработка изображений: описывается в функции preprocess_image, где изображение приводится к нужному размеру, нормализуется и конвертируется в тензор PyTorch.
- Обработка папки с изображениями: функция process_folder проходит по всем изображениям в указанной папке, предобрабатывает каждое изображение и запускает через модель для распознавания. Итоговые вероятности классификации выводятся в консоль после обработки всех изображений.

#####  Набор данных для детектирования и классификации объектов находится в папке train:

### Инструменты разработки

**Стек:**
- Python
- Torch
- Pillow
- torchvision

## Разработка

##### 1) Клонировать репозиторий

    git clone https://github.com/mi-bogdan/detection_and_classification_of_objects_in_images.git

##### 2) Создать виртуальное окружение

    python -m venv venv

##### 3) Активировать виртуальное окружение

    venv/Scripts/activate

##### 4) Устанавливить зависимости:

    pip install -r requirements.txt

##### 5) Запустить интерфецс для работы:
    python main.py

Copyright (c) 2024-present, - Shnyra Bogdan
